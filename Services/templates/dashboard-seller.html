{% extends "registration_base.html" %}
{% load static %}
{% load i18n %}
{% load custom_tags %} 
{% block title %} GustoMarket {% endblock %}

{% block content %}

<style>
  #products-table thead {
    font-size: 13px;
    color: #6F767E;
  }
  #products-table tbody {
    font-size: 14px;
    color: #1A1D1F;
  }
  .qty-container {
    display: flex;
    justify-content: flex-start;
    transform: scale(0.8);
    display: flex;
    padding-left = 0px;
  }
  .input-group {
    transform: scale(0.85);
    float: left;
  }
  .input-group-text {
    font-size: 14px;
  }
  .qty-container button {
    margin: 0px 2px;
    border-radius: 1px;
  }
  .qty-container .qty-btn-minus,
  .qty-container .qty-btn-plus {
      height: 15px;
      width: 15px;
  }
  .custom-check {
    padding-top: 3px;
  }
  #units {
    display: inline-block;
  }
  .modal-body {
    overflow-y: auto;
    max-height: calc(100vh - 250px);
  }
  .weight-width {
    width: 265px;
}
@media (max-width: 768px) {
    table th, table td {
      white-space: nowrap; 
      padding:10px;
    }
    .ordertbs-section.horiztl-tab {
      overflow-x: scroll;
      -webkit-overflow-scrolling: touch;
  }
  .tophead-right {
    padding-right: 0px !important;
    width: auto;
}
  }
  @media (max-width: 415px) {
    .sidebar {
        width: 100vw; 
        height: 100vh; 
        padding: 0; 
        top: 0;
        left: -100%;
        transition: all 0.3s ease-in-out; 
    }

   
    .sidebar.sidebar-open {
        left: 0;
    }
  }
  @media (max-width: 415px) {
    .sidebar .close-sidebar {
        display: block;
        position: absolute;
        top: 15px;
        right: 15px;
        background: transparent;
        border: none;
        font-size: 20px;
        color: var(--c-text-secondary);
        cursor: pointer;
        z-index: 20;
    }
}
</style>

<div class="content-wrapper content-wrapper-bg">
  <div class="flex-space position-relative">
    <h1 class="page-title">Dashboard</h1>
    <div class="filter-rating-sec d-flex gap-4 align-items-center">
      <div class="dash-rating-text d-flex gap-4 align-items-center">
        <img src="{% static 'img/star.png' %}" alt="star"> <span>4.8</span>
      </div>
      <div class="filter-wrapper">
        <button class="position-relative filter-btns filter-cliking" type="button">
          <img src="{% static 'img/filter-icon.png' %}" alt="filter">
        </button>
        <div class="dash-filter-show" style="display: none;">
          <div class="filter-section">
            <div class="tab-heading">
              <h3>Choose your Widgets</h3>
            </div>
            <div class="hr-line-small my-4 my-sm-5"></div>
            <div class="gary-txts mb-4">
              <p>Showing</p>
            </div>
            <div class="widgets-check-list">
              <div class="widget-listing flex-space mb-4">
                <div class="black-txts">
                  <p class="mb-0">Widget 1 </p>
                </div>
                <div class="custom-checkbox"> <label class="custom-check"><input type="checkbox" checked=""><span
                      class="checkmark"></span></label> </div>
              </div>
              <div class="widget-listing flex-space mb-4">
                <div class="black-txts">
                  <p class="mb-0">Widget 1 </p>
                </div>
                <div class="custom-checkbox"> <label class="custom-check"><input type="checkbox"><span
                      class="checkmark"></span></label> </div>
              </div>
              <div class="widget-listing flex-space mb-4">
                <div class="black-txts">
                  <p class="mb-0">Widget 3 </p>
                </div>
                <div class="custom-checkbox"> <label class="custom-check"><input type="checkbox"><span
                      class="checkmark"></span></label> </div>
              </div>
              <div class="widget-listing flex-space mb-4">
                <div class="black-txts">
                  <p class="mb-0">Widget 4 </p>
                </div>
                <div class="custom-checkbox"> <label class="custom-check"><input type="checkbox"><span
                      class="checkmark"></span></label> </div>
              </div>

            </div>
            <div class="hr-line-small my-4 my-sm-5"></div>

            <div class="d-flex justify-content-end gap-4">
              <button type="button" class="white-btn">Reset to Default</button>
              <button type="button" class="red-btn">Apply</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- start inner body section -->
  <div class="page-content whitebg-remove p-0">
    <!-- start Dashboard page -->
    <div class="dashboard-inners">
      <!-- start Overview section -->
      <div class="card-section mb-3">
        <div class="topoverview-sec flex-space mb-5">
          <div class="tab-heading">
            <h3>Overview
              {% for data in tooltip_data %}
              {% if data.tooltip_title|lower == 'overview' %}
              <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                data-bs-original-title="{{ data.tooltip_content }}">
              </i>
              {% endif %}
              {% endfor %}
            </h3>
          </div>
          <form method="GET" action="{% url 'seller_dashboard' %}">
            <div class="topoverview-sec d-flex">
              <div class="alltime-selects mx-3">
                <select class="selectpicker form-control" name="time_period">
                  <option value="all_time" {% if request.GET.time_period == "all_time" %}selected{% endif %}> All time
                  </option>
                  <option value="one_day" {% if request.GET.time_period == "one_day" %}selected{% endif %}>One day
                  </option>
                  <option value="two_day" {% if request.GET.time_period == "two_day" %}selected{% endif %}>Two day
                  </option>
                </select>
              </div>
              <button type="submit" class="red-btn">Apply</button>
            </div>
          </form>
        </div>

        <div class="overview-crd-bg mb-5">
          <div class="row">
            <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4">
              <div class="overview-card">
                <div class="overview-card-inner d-flex justify-content-between">
                  <div class="overview-crd-lef d-flex gap-4">
                    <div class="overcrd-img"><img src="{% static 'img/order-bag.png' %}" alt="order"></div>
                    <div class="overcrd-text">
                      <p class="mb-0">Orders
                        {% for data in tooltip_data %}
                        {% if data.tooltip_title|lower == 'orders' %}
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="{{ data.tooltip_content}} ">
                        </i>
                        {% endif %}
                        {% endfor %}
                      </p>
                      <h3>{{ order_count }}</h3>
                    </div>
                  </div>
                  <div class="overview-crd-rgt">
                    <div class="crd-incress-txt">
                      <b><i class="bi bi-arrow-down"></i> 37.8%</b>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4">
              <div class="overview-card">
                <div class="overview-card-inner d-flex justify-content-between">
                  <div class="overview-crd-lef d-flex gap-4">
                    <div class="overcrd-img"><img src="{% static 'img/order-bag.png' %}" alt="order"></div>
                    <div class="overcrd-text">
                      <p class="mb-0">Total Value
                        {% for data in tooltip_data %}
                        {% if data.tooltip_title|lower == 'total value' %}
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="{{ data.tooltip_content}}">
                        </i>
                        {% endif %}
                        {% endfor %}
                      </p>
                      <h3>${{ formatted_total_value}}</h3>
                    </div>
                  </div>
                  <div class="overview-crd-rgt">
                    <div class="crd-incress-txt">
                      <b><i class="bi bi-arrow-down"></i> 37.8%</b>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4">
              <div class="overview-card">
                <div class="overview-card-inner d-flex justify-content-between">
                  <div class="overview-crd-lef d-flex gap-4">
                    <div class="overcrd-img"><img src="{% static 'img/order-bag.png' %}" alt="order"></div>
                    <div class="overcrd-text">
                      <p class="mb-0">Fees
                        {% for data in tooltip_data %}
                        {% if data.tooltip_title|lower == 'fees' %}
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="{{ data.tooltip_content}}">
                        </i>
                        {% endif %}
                        {% endfor %}
                      </p>
                      <h3>${{ total_fee }}</h3>
                    </div>
                  </div>
                  <div class="overview-crd-rgt">
                    <div class="crd-incress-txt">
                      <b><i class="bi bi-arrow-down"></i> 37.8%</b>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- start Tickets section -->
      <div class="card-section">
        <div class="tickets-dash-sec">
          <div class="topoverview-sec flex-space mb-3">
            <div class="tab-heading">
              <h3>Tickets
                {% for data in tooltip_data %}
                {% if data.tooltip_title|lower == 'tickets' %}
                <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                  data-bs-original-title="{{ data.tooltip_content}}">
                </i>
                {% endif %}
                {% endfor %}
              </h3>
            </div>
            <div class="purchase-head-lft mb-5">
              <div class="graybg-tab">
                <ul class="nav nav-pills">
                  <li class="nav-item">
                    <button class="nav-link" id="sold-btn" data-bs-toggle="pill" data-bs-target="#sold-tb"
                      type="button">Sold</button>
                  </li>
                  <li class="nav-item">
                    <button class="nav-link" id="purchased-btn" data-bs-toggle="pill" data-bs-target="#purchased-tb"
                      type="button">Purchased</button>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="purchase-head-sec align-items-center">
            <div class="row">
              <div class="col-md-12">
                <div class="tab-content">
                  <!-- start sold tab -->
                  <div class="tab-sold" id="sold-tb">
                    <div class="row" id="sold-tb">
                      <!-- Ordered Section -->
                      <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4" data-status="ordered" style="display: block;">
                        <div class="tickets-card">
                          <div class="tab-heading mb-5 mt-3">
                            <h3>Ordered</h3>
                            <button id="ordered-sort-toggle" class="btn btn-secondary">Sort</button>
                          </div>
                          <div class="gary-txts orderd-hed flex-space">
                            <p class="mb-0">Products</p>
                            <p class="mb-0">Value</p>
                            <p class="mb-0">Uniques</p>
                          </div>
                          <div class="hr-line-small my-5"></div>
                          <div id="ordered-section">
                            {% for sold_item in sold_combined %}
                            {% if sold_item.0.order_status|lower == 'pending' %}
                            <div class="orderid-row flex-space mb-5" data-bs-toggle="modal" data-bs-target="#orderedprod-pop-{{ sold_item.0.id }}">
                              <div class="orderid-left d-flex gap-4">
                                <div class="orderid-img">
                                  {% if sold_item.0.product.productphoto_set.exists %}
                                  {% with photo=sold_item.0.product.productphoto_set.first %}
                                  <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 64px; width: 64px;">
                                  {% endwith %}
                                  {% endif %}
                                </div>
                                <div class="orderid-txt black-txts">
                                  <p>Order ID:</p>
                                  <p>{{ sold_item.0.order.orderID }}</p>
                                </div>
                              </div>
                              <div class="orderid-rgt">
                                <div class="orderid-price black-txts">
                                  <p>${{ sold_item.3 }}</p>
                                  <label>Open</label>
                                </div>
                              </div>
                              <div class="orderid-quantity black-txts">
                                <p>{{ sold_units|get_item:sold_item.0 }}</p>
                              </div>
                            </div>
                            {% endif %}
                            {% endfor %}
                          </div>
                        </div>
                      </div>
          
                      <!-- In Transit Section -->
                      <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4" data-status="in_transit" style="display: block;">
                        <div class="tickets-card">
                          <div class="tab-heading mb-5">
                            <h3>In Transit</h3>
                            <button id="in-transit-sort-toggle" class="btn btn-secondary">Sort</button>
                          </div>
                          <div class="gary-txts orderd-hed flex-space">
                            <p class="mb-0">Products</p>
                            <p class="mb-0">Value</p>
                          </div>
                          <div class="hr-line-small my-5"></div>
                          <div id="in-transit-section">
                            {% for sold_item in sold_combined %}
                            {% if sold_item.0.order_status|lower == 'in_transit' %}
                            <div class="orderid-row flex-space mb-5" data-bs-toggle="modal" data-bs-target="#transit-pop-{{ sold_item.0.id }}">
                              <div class="orderid-left d-flex gap-4">
                                <div class="orderid-img">
                                  {% if sold_item.0.product.productphoto_set.exists %}
                                  {% with photo=sold_item.0.product.productphoto_set.first %}
                                  <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 64px; width: 64px;">
                                  {% endwith %}
                                  {% endif %}
                                </div>
                                <div class="orderid-txt black-txts">
                                  <p>Order ID:</p>
                                  <p>{{ sold_item.0.order.orderID }}</p>
                                </div>
                              </div>
                              <div class="orderid-rgt">
                                <div class="orderid-price black-txts">
                                  <p>${{ sold_item.3 }}</p>
                                  <label>Open</label>
                                </div>
                              </div>
                            </div>
                            {% endif %}
                            {% endfor %}
                          </div>
                        </div>
                      </div>
          
                      <!-- Delivered Section -->
                      <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4" data-status="delivered" style="display: block;">
                        <div class="tickets-card">
                          <div class="tab-heading mb-5 mt-3">
                            <h3>Delivered</h3>
                            <button id="delivered-sort-toggle" class="btn btn-secondary">Sort</button>
                          </div>
                          <div class="gary-txts orderd-hed flex-space">
                            <p class="mb-0">Products</p>
                            <p class="mb-0">Value</p>
                            <p class="mb-0">Paid</p>
                          </div>
                          <div class="hr-line-small my-5"></div>
                          <div id="delivered-section">
                            {% for sold_item in sold_combined %}
                            {% if sold_item.0.order_status|lower == 'delivered' %}
                            <div class="orderid-row flex-space mb-5" data-bs-toggle="modal" data-bs-target="#delivered-pop-{{ sold_item.0.id }}">
                              <div class="orderid-left d-flex gap-4">
                                <div class="orderid-img">
                                  {% if sold_item.0.product.productphoto_set.exists %}
                                  {% with photo=sold_item.0.product.productphoto_set.first %}
                                  <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 64px; width: 64px;">
                                  {% endwith %}
                                  {% endif %}
                                </div>
                                <div class="orderid-txt black-txts">
                                  <p>Order ID:</p>
                                  <p>{{ sold_item.0.order.orderID }}</p>
                                </div>
                              </div>
                              <div class="orderid-rgt">
                                <div class="orderid-price black-txts">
                                  <p>${{ sold_item.3 }}</p>
                                  <label>Open</label>
                                </div>
                              </div>
                              <div class="rquest-date black-txts"><b class="bg-odr mb-0">
                                {% if sold_item.0.order.is_paid == False %} Unpaid {% else %} Paid {%endif%}
                              </b></div>
                            </div>
                            {% endif %}
                            {% endfor %}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>         
          <!-- End sold tab -->

                  <!-- start purchased tab -->
                  <div class="tab-sold" id="purchased-tb">
                    <div class="row" id="purchased-tb">
                      <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                        <div class="tickets-card">
                          <div class="tab-heading mb-5 mt-3">
                            <h3>Ordered
                              <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-original-title="Maximum 100 Character.">
                              </i>
                            </h3>
                            <button id="sort-ordered" class="btn btn-secondary">Sort</button>
                          </div>
                          <div class="gary-txts orderd-hed flex-space">
                            <p class="mb-0">Products</p>
                            <p class="mb-0">Value</p>
                            <p class="mb-0">Uniques</p>
                          </div>
                          <div class="hr-line-small my-5"></div>
                          {% for purchased_item in purchased_combined %}
                          {% if purchased_item.0.order_status|lower == 'pending' %}
                          <div class="orderid-row flex-space mb-5" data-bs-toggle="modal"
                            data-bs-target="#prchsdprod-pop-{{ purchased_item.0.id }}">

                            <div class="orderid-left d-flex gap-4">
                              <div class="orderid-img">
                                {% if purchased_item.0.product.productphoto_set.exists %}
                                {% with photo=purchased_item.0.product.productphoto_set.first %}
                                <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                                  style="height: 64px; width: 64px;">
                                {% endwith %}
                                {% endif %}
                              </div>
                              <div class="orderid-txt black-txts">
                                <p>Order ID:</p>
                                <p>{{ purchased_item.0.order.orderID }}</p>
                              </div>
                            </div>
                            <div class="orderid-rgt">
                              <div class="orderid-price black-txts">
                                <p>${{ purchased_item.3 }}</p>
                                <label>Active</label>
                              </div>
                            </div>
                            <div class="orderid-quantity black-txts">
                              <p>{{ purchased_units|get_item:purchased_item.0 }}</p>
                            </div>
                          </div>
                          {% endif %}
                          {% endfor %}
                        </div>
                      </div>

                      <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                        <div class="tickets-card" id="purchased-tc">
                          <div class="tab-heading mb-5 mt-3">
                            <h3>In Transit
                              <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-original-title="Maximum 100 Character.">
                              </i>
                              <button id="sort-in-transit" class="btn btn-secondary">Sort</button>
                            </h3>
                            
                          </div>
                          <div class="gary-txts orderd-hed flex-space">
                            <p class="mb-0">Products</p>
                            <p class="mb-0">Value</p>
                          </div>
                          <div class="hr-line-small my-5"></div>
                          {% for purchased_item in purchased_combined %}
                          {% if purchased_item.0.order_status|lower == 'in_transit' %}
                          <div class="orderid-row flex-space mb-5" data-bs-toggle="modal"
                            data-bs-target="#prchsd-transit-pop-{{ purchased_item.0.id }}">
                            <div class="orderid-left d-flex gap-4">
                              <div class="orderid-img">
                                {% if purchased_item.0.product.productphoto_set.exists %}
                                {% with photo=purchased_item.0.product.productphoto_set.first %}
                                <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                                  style="height: 64px; width: 64px;">
                                {% endwith %}
                                {% endif %}
                              </div>
                              <div class="orderid-txt black-txts">
                                <p>Order ID:</p>
                                <p>{{ purchased_item.0.order.orderID }}</p>
                              </div>
                            </div>
                            <div class="orderid-rgt">
                              <div class="orderid-price black-txts">
                                <p>${{ purchased_item.3 }}</p>
                                <label>Active</label>
                              </div>
                            </div>
                          </div>
                          {% endif %}
                          {% endfor %}
                        </div>
                      </div>

                      <div class="col-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                        <div class="tickets-card" id="purchased-td">
                          <div class="tab-heading mb-5 mt-3">
                            <h3>Delivered
                              <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-original-title="Maximum 100 Character.">
                              </i>
                            </h3>
                            <button id="sort-delivered" class="btn btn-secondary">Sort</button>
                          </div>
                          <div class="gary-txts orderd-hed flex-space">
                            <p class="mb-0">Products</p>
                            <p class="mb-0">Value</p>
                            <p class="mb-0">Paid</p>
                          </div>
                          <div class="hr-line-small my-5"></div>
                          {% for purchased_item in purchased_combined %}
                          {% if purchased_item.0.order_status|lower == 'delivered' %}
                          <div class="orderid-row flex-space mb-5" data-bs-toggle="modal"
                            data-bs-target="#prchsd-delivered-pop-{{ purchased_item.0.id }}">
                            <div class="orderid-left d-flex gap-4">
                              <div class="orderid-img">
                                <!-- <img src="{% static 'img/order-bag.png' %}" alt="order"> -->
                                {% if purchased_item.0.product.productphoto_set.exists %}
                                {% with photo=purchased_item.0.product.productphoto_set.first %}
                                <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                                  style="height: 64px; width: 64px;">
                                {% endwith %}
                                {% endif %}
                              </div>
                              <div class="orderid-txt black-txts">
                                <p>Order ID:</p>
                                <p>{{ purchased_item.0.order.orderID }}</p>
                              </div>
                            </div>
                            <div class="orderid-rgt">
                              <div class="orderid-price black-txts">
                                <p>${{ purchased_item.3 }}</p>
                                <label>Open</label>
                              </div>
                            </div>
                            <div class="rquest-date black-txts"><b class="bg-odr mb-0">
                              {% if purchased_item.0.order.is_paid == False %} Unpaid {% else %} Paid {%endif%}
                            </b></div>
                          </div>
                          {% endif %}
                          {% endfor %}
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- End purchased tab -->
                </div>
              </div>
            </div>
          </div>
        </div>
      <div>
      <!-- End Tickets section -->
    </div>
    <!-- End Dashboard page -->
  </div>
  <!-- End inner body section -->
</div>

<!-- Modal pop Order Products for Sold -->
{% for sold_item in sold_combined %}
<form action="{% url 'seller_dashboard' %}" method="post" id="sold-ordered-form-{{sold_item.0.order.orderID}}">
  {% csrf_token %}
  <input type="hidden" id="sold-ordered-publishAction-{{sold_item.0.order.orderID}}" name="sold_ordered_publish_action_{{sold_item.0.order.orderID}}" value="">
    <div class="modal fade" id="orderedprod-pop-{{ sold_item.0.id }}">
      <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content custom-modal-pop">
          <div class="modal-header">
            <h5 class="modal-title">Order Sell-side</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="orderproduct-pops">
              <div class="row">
                <div class="col-12 col-md-12 col-lg-6 col-xl-5">
                  <div class="ordertbs-section horiztl-tab">
                    <div class="order-details-form">
                      <div class="order-prod-bx d-flex align-items-center gap-4 mb-5">
                        <div class="orderprod-imgs">
                          {% if sold_item.0.product.productphoto_set.exists %}
                          {% with photo=sold_item.0.product.productphoto_set.first %}
                          <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 81px; size: 81px;">
                          {% endwith %}
                          {% endif %}
                        </div>
                        <div class="orderprod-txts">
                          <h3 class="mb-4">Order ID: {{ sold_item.0.order.orderID }}</h3>
                          <b class="bg-odr">Ordered</b>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Purchase date</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0" id="purchase-date">{{ sold_item.0.order.order_date }}</p>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Requested Date</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <input type="date" id="requested-date" name="requested-date" class="form-control" >
                        </div>
                      </div>
                      {% comment %} <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Products Delivered</p>
                        </div>
                        <div class="rquest-date black-txts"><b class="bg-odr mb-0">Pending</b></div>
                      </div> {% endcomment %}
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Customer</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{customer_names|get_item:sold_item.0.order.orderID}} | {{sold_item.0.order.customer.address.location}}</p>
                        </div>
                      </div>
                      <!--
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Purchase code</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">6373ads-hd73h-8373DS</p>
                        </div>
                      </div>-->
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Unique products</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{ sold_units|get_item:sold_item.0 }}</p>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Price <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip"
                              data-bs-placement="top" data-bs-original-title="Lorem ipsum"></i></p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">${{ sold_item.3 }}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <button type="button" onclick="window.open('/get-purchase-order/{{ sold_item.0.order.orderID }}/', '_blank')" class="red-btn">Purchase Order</button>
                  <button type="button" onclick="window.open('/get-picklist-data/{{ sold_item.0.order.orderID }}/', '_blank')" class="red-btn">Picking List</button>
                </div>
                <div class="col-12 col-md-12 col-lg-6 col-xl-7">
                  <div class="tansport-tnfortext mb-3">
                    <h3>Order History</h3>
                  </div>
                  <br>
                  <div class="request-change-rgt">
                    <div class="container mt-2">
                          <div style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); margin: 10px 0;">
                           <table style="width: 100%; border-collapse: collapse; text-align: center; font-size: 14px;">
                              <thead style="background-color: #f8f9fa;">
                                  <tr>
                                      <th style="border: 1px solid #ddd; padding: 8px;">GM Number</th>
                                      <th style="border: 1px solid #ddd; padding: 8px;">Change Type</th>
                                      <th style="border: 1px solid #ddd; padding: 8px;">Old Detail</th>
                                      <th style="border: 1px solid #ddd; padding: 8px;">New Detail</th>
                                      <th style="border: 1px solid #ddd; padding: 8px;">Date & Time</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  {% for change in sold_item.0.order_changes %}
                                      {% if change and change.change_type != 'create' %}
                                      <tr>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ sold_item.0.order.orderID }}</td>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ change.change_type }}</td>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ change.old_value }}</td>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ change.new_value }}</td>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ change.timestamp }}</td>
                                      </tr>
                                      {% endif %}
                                  {% empty %}
                                  <tr>
                                      <td colspan="6" style="border: 1px solid #ddd; padding: 8px; text-align: center;">No order history available</td>
                                  </tr>
                                  {% endfor %}
                              </tbody>
                          </table>
                         </div>
                   </div>
                    <br>
                    <div class="col-12 cus-inputs mt-4">
                      <label class="form-label">Add a comment
                        {% for data in tooltip_data %}
                        {% if data.tooltip_title|lower == 'optional message' %}
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="{{ data.tooltip_content}}">
                        </i>
                        {% endif %}
                        {% endfor %}
                      </label>
                      <textarea name="content" class="editor1-{{ sold_item.0.id }}"></textarea>
                      <input type="file" name="attachment" class="form-control mt-2">
                      
                    </div>
                    <!--
                    <div class="tab-heading mb-5 mt-3">
                      <h3>Request a Change</h3>
                    </div>
                    <div class="col-5 cus-inputs">
                      <br>
                      <label class="form-label">Reasons for change</label>
                      <select class="selectpicker form-control">
                        <option selected="selected">Select Reasons</option>
                        <option value="1">Rip/Hole</option>
                        <option value="2">Stained</option>
                        <option value="3">Mis-Matched</option>
                        <option value="3">Misssing Piece</option>
                        <option value="3">Product quality is not good</option>
                        <option value="3">Other</option>
                      </select>
                    </div>
                    <div class="img-vedio-sec-upload d-flex align-items-center gap-4">
                      <div class="img-upload-sec position-relative">
                        <div class="imgs-upload">
                          <div id="imagePreview" style="background-image: url('{% static 'img/dumy-imgs.png' %}')"></div>
                        </div>
                        <div class="avatar-edit">
                          <input type="file" id="imageUpload" accept=".png, .jpg, .jpeg">
                          <label for="imageUpload"><i class="bi bi-plus-lg"></i> </label>
                        </div>
                      </div>
                      <div class="vedio-uploads">
                        <div class="img-upload-sec position-relative">
                          <div class="imgs-upload">
                            <div id="imagePreview1" style="background-image: url('{% static 'img/vedio-dummy.png' %}')">
                            </div>
                          </div>
                          <div class="avatar-edit">
                            <input type="file" id="imageUpload1" accept=".png, .jpg, .jpeg">
                            <label for="imageUpload1"><i class="bi bi-plus-lg"></i> </label>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="black-txts">
                      <p>Add product items</p>
                    </div>-->
                    <!--<div class="order-prod-bx d-flex align-items-center gap-4 mb-5">
                      <div class="orderprod-imgs"><img src="{% static 'img/small-prod.png' %}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"></div>
                      <div class="qty-container d-flex align-items-center">
                        <button class="qty-btn-minus btn-primary btn-rounded mr-1" type="button"><i
                            class="bi bi-dash-lg"></i></button>
                        <input type="text" name="qty" value="0" class="input-qty input-rounded">
                        <button class="qty-btn-plus btn-primary btn-rounded ml-1" type="button"><i
                            class="bi bi-plus-lg"></i></button>
                      </div>
                    -->
                    <!--<div class="hr-line-small mb-5 mt-4"></div>-->

                    <!--#############DATE AND TIME CHANGES COMMENTED OUT TO BE REPLACED##################-->
                    <!-- <div class="datetimefiled-sec mt-5">
                      <div class="datetime-filed position-relative mb-3">
                        <label class="form-label">Date</label>
                        <input type="date" class="form-control">
                      </div>
                      <div class="datetime-filed position-relative">
                        <label class="form-label">Time</label>
                        <input type="time" class="form-control">
                      </div>
                    </div>
                    <div class="hr-line-small my-5"></div>
                    <div class="cus-textareas">
                      <textarea class="form-control" rows="2" placeholder="What you would like to request?"></textarea>
                    </div>
                    -->
                    <br>
                    <div class="modal-footer gap-4">
                      <a href="{% url 'help' %}" class="white-btn">Add a comment</a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="hr-line-small my-4 my-sm-5"></div>
                <div class="tab-heading mb-5 mt-3">
                  <h3>Products</h3>
                </div>
                <div class="ordertbs-section horiztl-tab">
                  <table id="products-table" style="width: 100%">
                    <thead>
                      <tr>
                        <th>Products </th>
                        <th>Units Requested</th>
                        <th>Units Picked
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                                    data-bs-original-title="Buyer may request a quantity change prior to picking items.">
                          </i>
                        </th>
                        <th>Unit Price</th>
                        <th style="margin-top: 2px; text-align: center; padding-right: 30px;">Weight for All Units </th>
                        <th style="text-align: center;">Price per Unit</th>
                        <th >Sub Total</th>
                        <th>Picked</th>
                      </tr>   
                    </thead>
                    <tbody>
                      {% for product_list in sold_item.2 %}
      
                      <tr>
                        <td> 
                          {% if product_list.0.product.productphoto_set.exists %}
                          {% with photo=product_list.0.product.productphoto_set.first %}
                          <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                            style="height: 64px; width: 64px;">
                          {% endwith %}
                          {% endif %} 
                          {{product_list.0.product.product_title}}
                        </td>
                        <td> <div id="units" class="bg-odr mb0"> <b> {{product_list.1 }} </b></div></td>
                        <td>
                          <div class="qty-container d-flex align-items-center">
                            <input type="text" data-meta='{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}' name="sold-item-qty-{{product_list.0.order.orderID}}" id="sold-item-qty-{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}" value="{{ product_list.1 }}" class="input-qty UnitValue input-rounded totalcal"  onchange="changeWeight(this)" onkeyup="changeWeight(this)">

                          </div>
                        </td>
                        <td><option value="notvalid" disabled selected="selected" style="padding-left: 4px;">{{ product_list.0.product.product_packaging.sku_unit }}</option>
                        </td>
                        <td class="weight-width">
                          <div class="input-group">
                            <input type="number" data-meta='{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}' class="form-control input-qty weightValue input-rounded totalcal" id="weight-{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}" name="weight-value-{{product_list.0.order.orderID}}"  step="1" value="1.00" min="1" onchange="changeWeight(this)" onkeyup="changeWeight(this)" style="width: 50px;"/>
                            
                             <select class="selectpicker form-control custom_select " id="weightUnit-{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}" name="weight-unit" style="width: 20px; padding-left: 4px;" disabled> 
                               {% if product_list.0.product.product_packaging.sku_sold %}
                                {% for choice in unit_choices %}
                                  <option value="{{ choice }}" 
                                  {% if choice == product_list.0.product.product_packaging.sku_sold %} disabled selected 
                                  {% endif %}> {{ choice }}</option>
                                {% endfor %}
                              {% else %} 
                              
                                  <option value="notvalid" disabled selected="selected" style="padding-left: 4px;">
                                   None</option>
                              
                              {% endif %} 
                            </select> 
                          </div>
                        </td>
                        <td class="pricing-width">
                          <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input  data-meta='{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}' type="number" class="form-control pricePerUnit" id="priceSingle-{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}" name="priceSingle-{{product_list.0.order.orderID}}" 
                            value="{{ product_list.0.total_price}}" class="input-qty input-rounded totalcal" min="0" onchange="changePrice(this)" onkeyup="changePrice(this)" style=" width: 70px;" />
                            <input type="hidden" value="" id="price-{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}" name="price-{{product_list.0.order.orderID}}" class="totalcal" />
                          </div>
                        </td>
                        <td class="pricing-width subtotal totalcal" id='priceText-{{product_list.0.order.orderID}}-{{ product_list.0.product.id }}'  value="{{ product_list.0.order.orderID }}">0.00</td>

                        <td>
                          <div class="custom-checkbox"> <label class="custom-check">
                            <input type="checkbox" class="product-checkbox common-checkbox"
                                value="{{ product_list.0.product.id }}" name="picked_products" id="pickedProducts"
                                {% if product_list.0.picked|lower == 'yes' %}checked disabled{% endif %}>
                            <span class="checkmark"></span></label></div>
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer gap-4">
            <button type="button" class="white-btn" data-bs-dismiss="modal"> Cancel</button>
            <button type="button" name="edit-products-button" class="red-btn" onclick="printPage('orderedprod-pop-{{ sold_item.0.id }}')">Print Page</button>
            <button type="button" name="edit-products-button" class="red-btn" id="sold-edit-products-{{ sold_item.0.order.orderID}}" value="{{ sold_item.0.order.orderID }}">Edit Products</button>
            <button type="button" name="sold-ordered-button" class="red-btn" id="from-ordered-{{ sold_item.0.order.orderID }}" value="{{ sold_item.0.order.orderID }}">In Transit</button>
          </div>
        </div>
      </div>
    </div>
  </input>
</form>
{% endfor %}

<!-- Modal pop In Transit Products for Sold -->
{% for sold_item in sold_combined %}
<form action="{% url 'seller_dashboard' %}" method="post" id="sold-in-transit-form-{{sold_item.0.order.orderID}}">
  {% csrf_token %}
  <input type="hidden" id="sold-in-transit-publishAction-{{sold_item.0.order.orderID}}" name="sold_in_transit_publish_action_{{sold_item.0.order.orderID}}" value="">
    <div class="modal fade" id="transit-pop-{{ sold_item.0.id }}">
      <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content custom-modal-pop">
          <div class="modal-header">
            <h5 class="modal-title">Order in transit Sell- side</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="orderproduct-pops">
              <div class="row">
                <div class="col-12 col-md-12 col-lg-6 col-xl-5">
                  <div class="ordertbs-section">
                    <div class="order-details-form">
                      <div class="order-prod-bx d-flex align-items-center gap-4 mb-5">
                        <div class="orderprod-imgs">
                          {% if sold_item.0.product.productphoto_set.exists %}
                          {% with photo=sold_item.0.product.productphoto_set.first %}
                          <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 81px; size: 81px;">
                          {% endwith %}
                          {% endif %}

                        </div>
                        <div class="orderprod-txts">
                          <h3 class="mb-4">Order ID: {{ sold_item.0.order.orderID }}</h3>
                          <b class="bg-odr">In Transit</b>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Purchase date</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{ sold_item.0.order.order_date }}</p>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Requested date</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <input type="date" class="form-control" name = "datePicker" id="datePicker"  value="{{ sold_item.0.requested_date|date:'Y-m-d' }}"/>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Customer</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{customer_names|get_item:sold_item.0.order.orderID}} | {{sold_item.0.order.customer.address.location}}</p>
                        </div>
                      </div>
                      <!--
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Purchase code</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">6373ads-hd73h-8373DS</p>
                        </div>
                      </div>-->
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Price
                            {% for data in tooltip_data %}
                            {% if data.tooltip_title|lower == 'price' %}
                            <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                              data-bs-original-title="{{ data.tooltip_content}}">
                            </i>
                            {% endif %}
                            {% endfor %}
                          </p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">${{ sold_item.3 }}</p>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Unique products</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{ sold_item.0.id }}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <br>
                  <br>
                  <button type="button" onclick="window.open('/get-purchase-order/{{ sold_item.0.order.orderID }}/', '_blank')" class="red-btn">Purchase Order</button>
                  <button type="button" onclick="window.open('/get-picklist-data/{{sold_item.0.order.orderID  }}/', '_blank')" class="red-btn">Picking List</button>
                </div>
                <div class="col-12 col-md-12 col-lg-6 col-xl-7">
                  <div class="request-change-rgt">
                    <div class="tansport-tnfortext mb-5">
                      <h3>Transport Information</h3>
                    </div>
                    <div class="expectdel-flexs flex-space">
                      <div class="gary-txts">
                        <p>Expected delivery</p>
                      </div>
                      <div class="black-txts">
                        <p>Aug 27, 2023</p>
                      </div>
                    </div>
                    <div class="hr-line-small mb-5 mt-4"></div>
                    <div class="tansport-tnfortext mb-5">
                      <h3>Issues with Products & Delivery</h3>
                    </div>
                    <div class="expectdel-flexs issueprdt-lists flex-space">
                      {% get_issues_by_order sold_item.0.order.orderID as delivery_issues %}
                      <div class="gary-txts">
                        <p class="mb-0">The delivery was perfect
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'the delivery was perfect' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title="{{ data.tooltip_content}}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>
                      <div class="black-txts d-flex gap-4 align-items-center">
                        <p class="mb-0">No</p>
                        <div class="cust-switch">
                          <label class="switch">
                            <input name="perfect_delivery" type="checkbox"
                            {% if delivery_issues and delivery_issues.perfect_delivery %} checked {% endif %}
                            ><span class="slider round"></span> </label>
                        </div>
                        <p class="mb-0">Yes</p>
                      </div>
                    </div>
                    <div class="expectdel-flexs issueprdt-lists flex-space">
                      <div class="gary-txts">
                        <p class="mb-0">Damages
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'damages' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title="{{ data.tooltip_content}}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>
    
                      <div class="black-txts d-flex gap-4 align-items-center">
                        <p class="mb-0">No</p>
                        <div class="cust-switch">
                          <label class="switch">
                            <input name="damage_check" type="checkbox" class="damages-click"
                            {% if delivery_issues and delivery_issues.damage_check %} checked {% endif %}
                            >
                            <span
                              class="slider round"></span> </label>
                        </div>
                        <p class="mb-0">Yes</p>
                      </div>
                    </div>
                    <div class="expectdel-flexs issueprdt-lists flex-space">
                      <div class="gary-txts">
                        <p class="mb-0">Missing product
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'missing product' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title="{{ data.tooltip_content}}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>
                      <div class="black-txts d-flex gap-4 align-items-center">
                        <p class="mb-0">No</p>
                        <div class="cust-switch">
                          <label class="switch"><input name="missing_product" type="checkbox"
                            {% if delivery_issues and delivery_issues.missing_product %} checked {% endif %}
                            ><span class="slider round"></span> </label>
                        </div>
                        <p class="mb-0">Yes</p>
                      </div>
                    </div>
                    <div class="expectdel-flexs issueprdt-lists flex-space">
                      <div class="gary-txts">
                        <p class="mb-0">Overall service
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'overall service' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title="{{ data.tooltip_content}}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>
                      <div class="black-txts d-flex gap-4 align-items-center">
                        <p class="mb-0">No</p>
                        <div class="cust-switch">
                          <label class="switch">
                            <input name="overall_service" type="checkbox" 
                            {% if delivery_issues and delivery_issues.overall_service %} checked {% endif %}
                            >
                            <span class="slider round"></span> </label>
                        </div>
                        <p class="mb-0">Yes</p>
                      </div>
                    </div>
                    <div class="cus-inputs damages-show" style="display: none;">
                      <label class="form-label">Reasons for Damages</label>
                      <div class="row">
                        <div class="col-5 cus-inputs mt-4">
                          <select name="damage_other_category" class="selectpicker form-control" id="damage-other">
                            <option selected="selected">Select Reasons</option>
                            <option value="1">Rip/Hole</option>
                            <option value="2">Stained</option>
                            <option value="3">Mis-Matched</option>
                            <option value="4">Missing Piece</option>
                            <option value="5">Product quality is not good</option>
                            <option value="other">Other</option>
                          </select>
                        </div>
                        <div class="col-5 cus-inputs mt-4" id="other" style="display: none;">
                          <input name="other_note" type="text" class="form-control mb-3" id="otherInput"
                            placeholder="Enter other information.">
                        </div>
                      </div>
                      <div class="hr-line-small mb-4"></div>
                    </div>
    
                    <div class="upload-proof mt-5">
                      <div class="col-12 cus-inputs mb-0">
                        <label class="form-label">Upload image</label>
                      </div>
    
                      <output id="Filelist"></output>
                      <span class="fileinput-button">
                        <span><i class="bi bi-camera"></i></span>
                        <input type="file" name="issue_files[]" id="files" multiple
                          accept="image/jpeg, image/png, image/gif,"><br />
                      </span>
                    </div>
    
                    <div class="col-12 cus-inputs">
                      <label class="form-label">Add a comment
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="Lorem ipsum"></i>
                      </label>
                      <textarea name="content" class="editor12-{{ sold_item.0.id }}"></textarea>
                      <input type="file" name="attachment" class="form-control mt-2">
                    </div>
                    <div class="modal-footer gap-4">
                      <a href="{% url 'help' %}" class="white-btn">Add a comment</a>
                    </div>
<!--                    <div class="modal-footer gap-4">-->
<!--                      <a href="{% url 'help' %}" class="white-btn">See an issue?</a>-->
<!--                    </div>-->
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="hr-line-small my-4 my-sm-5"></div>
                <div class="tab-heading mb-5 mt-3">
                  <h3>Products</h3>
                </div>
                <div class="ordertbs-section horiztl-tab">
                  <table id="products-table" style="width: 100%">
                    <thead>
                      <tr>
                        <th>Products </th>
                        <th>Units Sent</th>
                        <th>Units Received</th>
                        <th>Unit Price</th>
                        <th style="padding-right: 4px; text-align: center;">Weight for All Units</th>
                        <th style="text-align: center;">Price per Unit</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for product_list in sold_item.2 %}
                      <tr>
                        <td> 
                          {% if product_list.0.product.productphoto_set.exists %}
                          {% with photo=product_list.0.product.productphoto_set.first %}
                          <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                            style="height: 64px; width: 64px;">
                          {% endwith %}
                          {% endif %} 
                          {{product_list.0.product.product_title}}
                        </td>
                        <td>
                          <div class="qty-container d-flex align-items-center">
                            <input type="text" value="{{ product_list.1 }}" class="input-qty input-rounded" disabled>
                          </div>
                        </td>
                        <td>
                          <div class="qty-container d-flex align-items-center">
                            <!-- <button class="qty-btn-minus btn-primary btn-rounded mr-1" type="button"><i
                              class="bi bi-dash-lg"></i></button> -->
                            <input type="text" name="sold-item-qty-{{product_list.0.order.orderID}}" value="{{ product_list.1 }}" class="input-qty input-rounded">
                            <!-- <button class="qty-btn-plus btn-primary btn-rounded ml-1" type="button"><i
                              class="bi bi-plus-lg"></i></button> -->
                          </div>
                        </td>
                        <td><option value="notvalid" disabled selected="selected" style="padding-left: 4px;">{{ product_list.0.product.product_packaging.sku_unit }}</option></td>
                        <td class="weight-width">
                          <div class="input-group">
                            <input type="number" class="form-control" name="weight-value-{{product_list.0.order.orderID}}" 
                            value="{{ product_list.0.skusold_weight }}" class="input-qty input-rounded" disabled>
                            <select class="selectpicker form-control custom_select" name="weight-unit" style="width: 20px;" disabled>
                              {% if product_list.0.product.product_packaging.sku_sold %}
                                {% for choice in unit_choices %}
                                  <option value="{{ choice }}" 
                                  {% if choice == product_list.0.product.product_packaging.sku_sold %} disabled selected 
                                  {% endif %}> {{ choice }}</option>
                                {% endfor %}
                              {% else %}
                                  <option value="notvalid" disabled selected="selected">None</option>
                              {% endif %}
                            </select>
                          </div>
                        </td>
                        <td class="pricing-width">
                          <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" value="{{ product_list.0.total_price}}" class="input-qty input-rounded" disabled>
                          </div>
                        </td>
                      </tr>
                      {% endfor %}
                    
                    </tbody>
                  </table>
                </div>
              </div>
            </div> 
          </div>
          <div class="modal-footer gap-4">
            <button type="button" class="white-btn" data-bs-dismiss="modal"> Cancel</button>
            <button type="button" name="sold-in-transit-button-in-orderd" class="red-btn" 
                    id="from-in-transit-{{ sold_item.0.order.orderID }}" 
                    value="{{ sold_item.0.order.orderID }}">
                Move to Ordered
            </button>
            <button type="button" name="sold-in-transit-button" class="red-btn" id="from-in-transit-{{ sold_item.0.order.orderID }}" value="{{ sold_item.0.order.orderID }}">Submit</button>
          </div>
        </div>
      </div>
    </div>
  </input>
</form>
{% endfor %}

<!-- Modal pop Delivered Productfor Sold --> 
{% for sold_item in sold_combined %}
<form action="{% url 'seller_dashboard' %}" method="post" id="sold-in-delivered-form-{{sold_item.0.order.orderID}}">
  {% csrf_token %}
  <input type="hidden" id="sold-in-delivered-publishAction-{{sold_item.0.order.orderID}}" name="sold_in_delivered_publish_action_{{sold_item.0.order.orderID}}" value="">
    <div class="modal fade" id="delivered-pop-{{ sold_item.0.id }}">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content custom-modal-pop">
        <div class="modal-header">
          <h5 class="modal-title">Order Delivered</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="orderproduct-pops">
            <div class="row">
              <div class="col-12 col-md-12 col-lg-6 col-xl-5">
                <div class="ordertbs-section horiztl-tab">
                  <div class="order-details-form">
                    <div class="order-prod-bx d-flex align-items-center gap-4 mb-5">
                      <div class="orderprod-imgs">
                        {% if sold_item.0.product.productphoto_set.exists %}
                        {% with photo=sold_item.0.product.productphoto_set.first %}
                        <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 81px; size: 81px;">
                        {% endwith %}
                        {% endif %}
                      </div>
                      <div class="orderprod-txts">
                        <h3 class="mb-4">Order ID: {{ sold_item.0.order.orderID }}</h3>
                        <b class="bg-odr">Delivered</b>
                      </div>
                    </div>
                    <div class="rquestsend-row flex-space py-3">
                      <div class="rquest-name gary-txts">
                        <p class="mb-0">Request send</p>
                      </div>
                      <div class="rquest-date black-txts">
                        <p class="mb-0">Jul 24, 2023</p>
                      </div>
                    </div>
                    <div class="rquestsend-row flex-space py-3">
                      <div class="rquest-name gary-txts">
                        <p class="mb-0">The delivery was perfect</p>
                      </div>
                      <div class="rquest-date black-txts"><b class="bg-odr mb-0">Yes</b></div>
                    </div>
                    <div class="rquestsend-row flex-space py-3">
                      <div class="rquest-name gary-txts">
                        <p class="mb-0">Purchase date</p>
                      </div>
                      <div class="rquest-date black-txts">
                        <p class="mb-0">{{ sold_item.0.order.order_date }}</p>
                      </div>
                    </div>
                    <div class="rquestsend-row flex-space py-3">
                      <div class="rquest-name gary-txts">
                        <p class="mb-0">Customer</p>
                      </div>
                      <div class="rquest-date black-txts">
                        <p class="mb-0">{{customer_names|get_item:sold_item.0.order.orderID}}</p>
                      </div>
                    </div>
                    <!--
                    <div class="rquestsend-row flex-space py-3">
                      <div class="rquest-name gary-txts">
                        <p class="mb-0">Purchase code</p>
                      </div>
                      <div class="rquest-date black-txts">
                        <p class="mb-0">6373ads-hd73h-8373DS</p>
                      </div>
                    </div>-->
                    <div class="rquestsend-row flex-space py-3">
                      <div class="rquest-name gary-txts">
                        <p class="mb-0">Price
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'price' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title="{{ data.tooltip_content}}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>
                      <div class="rquest-date black-txts">
                        <p class="mb-0">${{ sold_item.3 }}</p>
                      </div>
                    </div>
                  </div>
                </div>
                <br>
                <br>
                <button type="button" onclick="window.open('/get-invoice-data/{{ sold_item.0.order.orderID }}/', '_blank')" class="red-btn">Invoice</button>
                <button type="button" onclick="window.open('/get-picklist-data/{{sold_item.0.order.orderID  }}/', '_blank')" class="red-btn">Picking List</button>            </div>
              <div class="col-12 col-md-12 col-lg-6 col-xl-7">
                <div class="request-change-rgt">
                  <div class="tansport-tnfortext mb-5">
                    <h3>Payment</h3>
                  </div>
                  <div class="expectdel-flexs issueprdt-lists flex-space">
                    <div class="gary-txts">
                      <p class="mb-0">Order Paid
                        {% for data in tooltip_data %}
                        {% if data.tooltip_title|lower == 'item paid' %}
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="{{ data.tooltip_content}}">
                        </i>
                        {% endif %}
                        {% endfor %}
                      </p>
                    </div>
                    <div class="black-txts d-flex gap-4 align-items-center">
                      <p class="mb-0">No</p>
                      <div class="cust-switch">
                        <label class="switch">
                          <input name="order_paid" type="checkbox"
                          {% if sold_item.0.order.is_paid %}checked{%endif%}
                          >
                          <span class="slider round"></span> </label>
                      </div>
                      <p class="mb-0">Yes</p>
                    </div>
                  </div>
                  <!--
                  <div class="expectdel-flexs issueprdt-lists flex-space">
                    <div class="gary-txts">
                      <p class="mb-0">Damages
                        {% for data in tooltip_data %}
                        {% if data.tooltip_title|lower == 'damages' %}
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="{{ data.tooltip_content}}">
                        </i>
                        {% endif %}
                        {% endfor %}
                      </p>
                    </div>

                    <div class="black-txts d-flex gap-4 align-items-center">
                      <p class="mb-0">No</p>
                      <div class="cust-switch">
                        <label class="switch"><input type="checkbox" class="damages-click"><span
                            class="slider round"></span> </label>
                      </div>
                      <p class="mb-0">Yes</p>
                    </div>
                  </div>
                  <div class="expectdel-flexs issueprdt-lists flex-space">
                    <div class="gary-txts">
                      <p class="mb-0">Missing product
                        {% for data in tooltip_data %}
                        {% if data.tooltip_title|lower == 'missing product' %}
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="{{ data.tooltip_content}}">
                        </i>
                        {% endif %}
                        {% endfor %}
                      </p>
                    </div>
                    <div class="black-txts d-flex gap-4 align-items-center">
                      <p class="mb-0">No</p>
                      <div class="cust-switch">
                        <label class="switch"><input type="checkbox" checked><span class="slider round"></span> </label>
                      </div>
                      <p class="mb-0">Yes</p>
                    </div>
                  </div>
                  <div class="expectdel-flexs issueprdt-lists flex-space">
                    <div class="gary-txts">
                      <p class="mb-0">Overall service
                        {% for data in tooltip_data %}
                        {% if data.tooltip_title|lower == 'overall service' %}
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="{{ data.tooltip_content}}">
                        </i>
                        {% endif %}
                        {% endfor %}
                      </p>
                    </div>
                    <div class="black-txts d-flex gap-4 align-items-center">
                      <p class="mb-0">No</p>
                      <div class="cust-switch">
                        <label class="switch"><input type="checkbox" checked><span class="slider round"></span> </label>
                      </div>
                      <p class="mb-0">Yes</p>
                    </div>
                  </div>
                  <div class="cus-inputs damages-show" style="display: none;">
                    <label class="form-label">Reasons for Damages</label>
                    <div class="row">
                      <div class="col-5 cus-inputs mt-4">
                        <select class="selectpicker form-control" id="damage-other">
                          <option selected="selected">Select Reasons</option>
                          <option value="1">Rip/Hole</option>
                          <option value="2">Stained</option>
                          <option value="3">Mis-Matched</option>
                          <option value="4">Missing Piece</option>
                          <option value="5">Product quality is not good</option>
                          <option value="other">Other</option>
                        </select>
                      </div>
                      <div class="col-5 cus-inputs mt-4" id="other" style="display: none;">
                        <input type="text" class="form-control mb-3" id="otherInput"
                          placeholder="Enter other information.">
                      </div>
                    </div>
                    <div class="hr-line-small mb-4"></div>
                  </div> -->

  <!--                <div class="upload-proof mt-5">-->
  <!--                  <div class="col-12 cus-inputs mb-0">-->
  <!--                    <label class="form-label">Upload image</label>-->
  <!--                  </div>-->

  <!--                  <output id="Filelist"></output>-->
  <!--                  <span class="fileinput-button">-->
  <!--                    <span><i class="bi bi-camera"></i></span>-->
  <!--                    <input type="file" name="files[]" id="files" multiple-->
  <!--                      accept="image/jpeg, image/png, image/gif,"><br />-->
  <!--                  </span>-->
  <!--                </div> -->

                  <div class="col-12 cus-inputs mt-4">
                    <label class="form-label">Optional message
                      {% for data in tooltip_data %}
                      {% if data.tooltip_title|lower == 'optional message' %}
                      <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                        data-bs-original-title="{{ data.tooltip_content}}">
                      </i>
                      {% endif %}
                      {% endfor %}
                    </label>
                    <textarea name="content" class="editor2-{{ sold_item.0.id }}"></textarea>
                  </div>
                  <div class="modal-footer gap-4">
                    <a href="{% url 'help' %}" class="white-btn">See an issue?</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
                  <div class="hr-line-small my-4 my-sm-5"></div>
                  <div class="tab-heading mb-5 mt-3">
                    <h3>Products</h3>
                  </div>
                  <div class="ordertbs-section horiztl-tab">
                    <table id="products-table" style="width: 100%">
                      <thead>
                        <tr>
                          <th>Products </th>
                          <th>Units Sent
                            <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                                      data-bs-original-title="Request a quantity change while the products have not been picked.">
                            </i>
                          </th>
                          <th>Weight for All Units</th>
                          <th>Price per Unit</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for product_list in sold_item.2 %}
                        <tr>
                          <td> 
                            {% if product_list.0.product.productphoto_set.exists %}
                            {% with photo=product_list.0.product.productphoto_set.first %}
                            <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                              style="height: 64px; width: 64px;">
                            {% endwith %}
                            {% endif %} 
                            {{product_list.0.product.product_title}}
                          </td>
                          <td>
                            <div class="qty-container d-flex align-items-center">
                              <input type="text" value="{{ product_list.1 }}" class="input-qty input-rounded" disabled>
                            </div>
                          </td>
                          <td class="weight-width">
                            <div class="input-group">
                              <input type="number" class="form-control"  id="weight-{{product_list.0.order.orderID}}" name="weight-value-{{product_list.0.order.orderID}}" 
                              value="{{ product_list.0.skusold_weight }}" class="input-qty input-rounded" disabled>
                              <select class="selectpicker form-control custom_select" name="weight-unit" style="width: 20px;">
                                {% if product_list.0.product.product_packaging.sku_sold %}
                                  {% for choice in unit_choices %}
                                    <option value="{{ choice }}" 
                                    {% if choice == product_list.0.product.product_packaging.sku_sold %} disabled selected 
                                    {% endif %}> {{ choice }}</option>
                                  {% endfor %}
                                {% else %}
                                    <option value="notvalid" disabled selected="selected">None</option>
                                {% endif %}
                              </select>
                            </div>
                          </td>
                          <td class="pricing-width">
                            <div class="input-group">
                              <span class="input-group-text">$</span>
                              <input type="number" class="form-control" value="{{ product_list.0.total_price}}" class="input-qty input-rounded" disabled>
                            </div>
                          </td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
          </div>
        </div>
        <div class="modal-footer gap-4">
          <button type="button" class="white-btn" data-bs-dismiss="modal"> Cancel</button>
          <button type="button" name="sold-in-delivered-button" class="red-btn" id="from-in-delivered-{{ sold_item.0.order.orderID }}" value="{{ sold_item.0.order.orderID }}">Submit</button>
        </div>
      </div>
    </div>
    </div>
  </input>
</form>
{% endfor %}


<!-- Modal pop Order Products for purchased -->
{% for purchased_item in purchased_combined %}
<form action="{% url 'seller_dashboard' %}" method="post" 
id="purchased-ordered-form-{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}">
  {% csrf_token %}
  <input type="hidden" id="purchased-ordered-publishAction-{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}" 
  name="purchased_ordered_publish_action_{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}" value="">
    <div class="modal fade" id="prchsdprod-pop-{{ purchased_item.0.id }}">
      <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content custom-modal-pop">
          <div class="modal-header">
            <h5 class="modal-title">Order Buy-side</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="orderproduct-pops">
              <div class="row">
                <div class="col-12 col-md-12 col-lg-6 col-xl-5">
                  <div class="ordertbs-section">
                    <div class="order-details-form">
                      <div class="order-prod-bx d-flex align-items-center gap-4 mb-5">
                        <div class="orderprod-imgs">
                          {% if purchased_item.0.product.productphoto_set.exists %}
                          {% with photo=purchased_item.0.product.productphoto_set.first %}
                          <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 81px; width: 81px;">
                          {% endwith %}
                          {% endif %}
                        </div>
                        <div class="orderprod-txts">
                          <h3 class="mb-4">Order ID: {{ purchased_item.0.order.orderID }}</h3>
                          <b class="bg-odr">Ordered</b>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Purchase date</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{ purchased_item.0.order.order_date }}</p>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Requested date</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <input type="date" id="requested-date" name="requested-date" class="form-control" value="2023-07-24">
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Supplier</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{purchased_item.0.product.supplier.company.company_name }}, {{purchased_item.0.product.supplier.company.address.location }}</p>
                        </div>
                      </div>
                      <!--
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Purchase code</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">6373ads-hd73h-8373DS</p>
                        </div>
                      </div>-->
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Unique products</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{ purchased_units|get_item:purchased_item.0  }}</p>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Price <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip"
                              data-bs-placement="top" data-bs-original-title="Lorem ipsum"></i></p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">${{ purchased_item.3 }}</p>
                        </div>
                      </div>
                      <button type="button" onclick="window.open('/get-purchase-order/{{ purchased_item.0.order.orderID }}/', '_blank')" class="red-btn">Purchase Order</button>

                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-12 col-lg-6 col-xl-7">
                  <div class="tansport-tnfortext mb-5">
                    <h3>Order history</h3>
                  </div>
                  <div class="request-change-rgt">
                    <div class="container mt-2">
                          <div style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); margin: 10px 0;">
                           <table style="width: 100%; border-collapse: collapse; text-align: center; font-size: 14px;">
                              <thead style="background-color: #f8f9fa;">
                                  <tr>
                                      <th style="border: 1px solid #ddd; padding: 8px;">GM Number</th>
                                      <th style="border: 1px solid #ddd; padding: 8px;">Change Type</th>
                                      <th style="border: 1px solid #ddd; padding: 8px;">Old Detail</th>
                                      <th style="border: 1px solid #ddd; padding: 8px;">New Detail</th>
                                      <th style="border: 1px solid #ddd; padding: 8px;">Date & Time</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  {% for change in purchased_item.0.order_changes %}
                                      {% if change and change.change_type != 'create' %}
                                      <tr>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ purchased_item.0.order.orderID }}</td>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ change.change_type }}</td>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ change.old_value }}</td>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ change.new_value }}</td>
                                          <td style="border: 1px solid #ddd; padding: 8px;">{{ change.timestamp }}</td>
                                      </tr>
                                      {% endif %}
                                  {% empty %}
                                  <tr>
                                      <td colspan="6" style="border: 1px solid #ddd; padding: 8px; text-align: center;">No order history available</td>
                                  </tr>
                                  {% endfor %}
                              </tbody>
                          </table>
                         </div>
                    </div>
                    <br>
                    <div class="col-12 cus-inputs">
                      <label class="form-label">Add a comment
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="Lorem ipsum"></i>
                      </label>
                      <textarea name="content" class="editor4-{{ purchased_item.0.id }}"></textarea>
                      <input type="file" name="attachment" class="form-control mt-2">
                    </div>
                    <!--
                    <div class="img-vedio-sec-upload d-flex align-items-center gap-4">
                      <div class="img-upload-sec position-relative">
                        <div class="imgs-upload">
                          <div id="imagePreview" style="background-image: url({% static 'img/dumy-imgs.png' %})"></div>
                        </div>
                        <div class="avatar-edit">
                          <input type="file" id="imageUpload" accept=".png, .jpg, .jpeg">
                          <label for="imageUpload"><i class="bi bi-plus-lg"></i> </label>
                        </div>
                      </div>
                      <div class="vedio-uploads">
                        <div class="img-upload-sec position-relative">
                          <div class="imgs-upload">
                            <div id="imagePreview1" style="background-image: url({% static 'img/vedio-dummy.png' %})"></div>
                          </div>
                          <div class="avatar-edit">
                            <input type="file" id="imageUpload1" accept=".png, .jpg, .jpeg">
                            <label for="imageUpload1"><i class="bi bi-plus-lg"></i> </label>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="hr-line-small mb-5 mt-4"></div>
                    <div class="delivery-time mb-5">
                      <p>Request a delivery date and time change.</p>
                    </div>
                    <div class="datetimefiled-sec">
                      <div class="datetime-filed position-relative mb-3">
                        <label class="form-label">Date</label>
                        <input type="date" class="form-control">
                      </div>
                      <div class="datetime-filed position-relative">
                        <label class="form-label">Time</label>
                        <input type="time" class="form-control">
                      </div>
                    </div>
                    <div class="cus-textareas mt-5">
                      <textarea class="form-control" rows="2" placeholder="What you would like to request?"></textarea>
                    </div>
                  -->
                  </div>
                  <br>
                  <div class="modal-footer gap-4">
                    <a href="{% url 'help' %}" class="white-btn">See an issue?</a>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="hr-line-small my-4 my-sm-5"></div>
                <div class="tab-heading mb-5 mt-3">
                  <h3>Products</h3>
                </div>
                <div class="ordertbs-section horiztl-tab">
                  <table id="products-table" style="width: 100%">
                    <thead>
                      <tr>
                        <th>Products </th>
                        <th>Units {% if purchased_item.0.picked|lower == 'yes' %} Picked {% else %} Requested {% endif %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                                    data-bs-original-title="Request a quantity change while the products have not been picked.">
                          </i>
                        </th>
                        <th style="padding:2%">Weight for All Units</th>
                        <th>Price per Unit</th>
                        <th>Picked</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for product_list in purchased_item.2 %}
                      <tr>
                        <td> 
                          {% if product_list.0.product.productphoto_set.exists %}
                          {% with photo=product_list.0.product.productphoto_set.first %}
                          <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                            style="height: 64px; width: 64px;">
                          {% endwith %}
                          {% endif %} 
                          {{product_list.0.product.product_title}}
                        </td>
                        <td>
                          <div class="qty-container d-flex align-items-center">
                            {% if product_list.0.picked|lower == 'yes' %} 
                            <div id="units" class="bg-odr mb0"> <b> {{product_list.1 }} </b></div>
                            {% else %}
                            <input type="text" name="purchased-item-qty-{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}" 
                            value="{{product_list.1}}" class="input-qty input-rounded">
                          {% endif %}
                          </div>
                        </td>
                        <td class="weight-width">
                          <div class="input-group">
                            <input type="number" class="form-control" name="weight-value-{{product_list.0.order.orderID}}" 
                            value="{{ product_list.0.skusold_weight }}" class="input-qty input-rounded" disabled>
                            <select class="selectpicker form-control custom_select" name="weight-unit" style="width: 20px;" disabled>
                                  <option value="notvalid" disabled selected="selected">{{product_list.0.product.product_packaging.sku_sold}}</option>
                            </select>
                          </div>
                        </td>
                        <td class="pricing-width">
                          <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" name="price-{{purchased_item.0.order.orderID}}" 
                            value="{{ product_list.0.total_price}}" class="input-qty input-rounded" disabled>
                          </div>
                        </td>
                        <td> 
                          {% if product_list.0.picked|lower == 'yes' %}
                          <div id="units" class="bg-odr mb0"><b> Picked </b></div>
                          {% else %}
                          <div id="units" class="bg-odr mb0"><b> Not Picked </b></div>
                          {%endif %}
                        </td>
                        
                        <td>
                          <label class="custom-check" for="editableCheckbox">
                              <input type="checkbox" id="editableCheckbox" name="checked">
                              <span class="checkmark"></span>
                          </label>
                        </td>
                        <td>
                          <label class="custom-check" for="editableCheckbox">
                              <input type="checkbox" id="editableCheckbox" name="checked">
                              <span class="checkmark"></span>
                          </label>
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer gap-4">
            <button type="button" class="white-btn" data-bs-dismiss="modal"> Cancel</button>
            <button type="button" name="purchased-ordered-button" class="red-btn" 
            id="purchased-ordered-{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}" 
            value="{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}">Send Request</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
{% endfor %}

<!-- Modal pop In Transit Products for purchased -->
{% for purchased_item in purchased_combined %}
<form action="{% url 'seller_dashboard' %}" method="post" 
id="purchased-in-transit-form-{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}">
  {% csrf_token %}
  <input type="hidden" id="purchased-in-transit-publishAction-{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}" 
  name="purchased_in_transit_publish_action_{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}" value="">

<!--  Order in Transit pop up section start-->
    <div class="modal fade" id="prchsd-transit-pop-{{ purchased_item.0.id }}">
      <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content custom-modal-pop">
          <div class="modal-header">
            <h5 class="modal-title">Order in Transit</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="orderproduct-pops">
              <div class="row">
                <div class="col-12 col-md-12 col-lg-6 col-xl-5">
                  <div class="ordertbs-section">
                    <div class="order-details-form">
                      <div class="order-prod-bx d-flex align-items-center gap-4 mb-5">
                        <div class="orderprod-imgs">
                          {% if purchased_item.0.product.productphoto_set.exists %}
                          {% with photo=purchased_item.0.product.productphoto_set.first %}
                          <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 81px; width: 81px;">
                          {% endwith %}
                          {% endif %}
                        </div>
                        <div class="orderprod-txts">
                          <h3 class="mb-4">Order ID: {{ purchased_item.0.order.orderID }}</h3>
                          <b class="bg-odr">In Transit</b>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Request send</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">Jul 24, 2023</p>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Products Delivered</p>
                        </div>
                        <div class="rquest-date black-txts"><b class="bg-odr mb-0">In Transit</b></div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Purchase date</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{ purchased_item.0.order.order_date }}</p>
                        </div>
                      </div>
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Supplier</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">{{purchased_item.0.product.supplier.company.company_name }}</p>
                        </div>
                      </div>
                      <!--
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Purchase code</p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">6373ads-hd73h-8373DS</p>
                        </div>
                      </div>-->
                      <div class="rquestsend-row flex-space py-3">
                        <div class="rquest-name gary-txts">
                          <p class="mb-0">Price <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip"
                              data-bs-placement="top" data-bs-original-title="Lorem ipsum"></i></p>
                        </div>
                        <div class="rquest-date black-txts">
                          <p class="mb-0">${{ purchased_item.0.total_price }}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <br>
                  <br>
                  <button type="button" onclick="window.location.href='/get-invoice-data/{{ sold_item.0.order.orderID }}/'" class="red-btn">Invoice</button>
                  <button type="button" onclick="window.location.href='/get-picklist-data/{{sold_item.0.order.orderID  }}/'" class="red-btn">Picking List</button>
                </div>
                <div class="col-12 col-md-12 col-lg-6 col-xl-7">
                  <div class="request-change-rgt">
                    <div class="tansport-tnfortext mb-5">
                      <h3>Transport Information</h3>
                    </div>
                    <div class="expectdel-flexs flex-space">
                      <div class="gary-txts">
                        <p>Expected delivery</p>
                      </div>
                      <div class="black-txts">
                        <p>Aug 27, 2023</p>
                      </div>
                    </div>
                    <div class="hr-line-small mb-5 mt-4"></div>
                    <div class="tansport-tnfortext mb-5">
                      <h3>Issues with Products & Delivery</h3>
                    </div>

                    <div class="expectdel-flexs issueprdt-lists flex-space">
                      <div class="gary-txts">
                        <p class="mb-0">The delivery was perfect
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'the delivery was perfect' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title="{{ data.tooltip_content}}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>

                      <div class="black-txts d-flex gap-4 align-items-center">
                        <p class="mb-0">No</p>
                        <div class="cust-switch">
                          <label class="switch">
                            <input type="checkbox">
                            <span class="slider round"></span> 
                          </label>
                        </div>
                        <p class="mb-0">Yes</p>
                      </div>
                    </div>
                    <div class="expectdel-flexs issueprdt-lists flex-space">
                      <div class="gary-txts">
                        <p class="mb-0">Damages
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'damages' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title=" {{ data.tooltip_content }}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>

                      <div class="black-txts d-flex gap-4 align-items-center">
                        <p class="mb-0">No</p>
                        <div class="cust-switch">
                          <label class="switch"><input type="checkbox" class="damages-click"><span
                              class="slider round"></span> </label>
                        </div>
                        <p class="mb-0">Yes</p>
                      </div>
                    </div>
                    <div class="expectdel-flexs issueprdt-lists flex-space">
                      <div class="gary-txts">
                        <p class="mb-0">Missing product
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'missing product' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title="{{ data.tooltip_content}}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>
                      <div class="black-txts d-flex gap-4 align-items-center">
                        <p class="mb-0">No</p>
                        <div class="cust-switch">
                          <label class="switch"><input type="checkbox" checked><span class="slider round"></span> </label>
                        </div>
                        <p class="mb-0">Yes</p>
                      </div>
                    </div>
                    <div class="expectdel-flexs issueprdt-lists flex-space">
                      <div class="gary-txts">
                        <p class="mb-0">Overall service
                          {% for data in tooltip_data %}
                          {% if data.tooltip_title|lower == 'overall service' %}
                          <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                            data-bs-original-title="{{ data.tooltip_content}}">
                          </i>
                          {% endif %}
                          {% endfor %}
                        </p>
                      </div>
                      <div class="black-txts d-flex gap-4 align-items-center">
                        <p class="mb-0">No</p>
                        <div class="cust-switch">
                          <label class="switch"><input type="checkbox" checked><span class="slider round"></span> </label>
                        </div>
                        <p class="mb-0">Yes</p>
                      </div>
                    </div>
                    <div class="cus-inputs damages-show" style="display: none;">
                      <label class="form-label">Reasons for Damages</label>
                      <div class="row">
                        <div class="col-5 cus-inputs mt-4">
                          <select class="selectpicker form-control" id="damage-other">
                            <option selected="selected">Select Reasons</option>
                            <option value="1">Rip/Hole</option>
                            <option value="2">Stained</option>
                            <option value="3">Mis-Matched</option>
                            <option value="4">Missing Piece</option>
                            <option value="5">Product quality is not good</option>
                            <option value="other">Other</option>
                          </select>
                        </div>
                        <div class="col-5 cus-inputs mt-4" id="other" style="display: none;">
                          <input type="text" class="form-control mb-3" id="otherInput"
                            placeholder="Enter other information.">
                        </div>
                      </div>
                      <div class="hr-line-small mb-4"></div>
                    </div>

                    <div class="upload-proof mt-5">
                      <div class="col-12 cus-inputs mb-0">
                        <label class="form-label">Upload image</label>
                      </div>

                      <output id="Filelist"></output>
                      <span class="fileinput-button">
                        <span><i class="bi bi-camera"></i></span>
                        <input type="file" name="files[]" id="files" multiple
                          accept="image/jpeg, image/png, image/gif,"><br />
                      </span>
                    </div>
                    <div class="col-12 cus-inputs">
                      <label class="form-label">Message for Seller
                        <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-original-title="Lorem ipsum"></i>
                      </label>
                      <textarea name="content" class="editor3-{{ purchased_item.0.id }}"></textarea>
                      <input type="file" name="attachment" class="form-control mt-2">
                    </div>
                    <div class="modal-footer gap-4">
                      <a href="{% url 'help' %}" class="white-btn">See an issue?</a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="hr-line-small my-4 my-sm-5"></div>
                <div class="tab-heading mb-5 mt-3">
                  <h3>Products</h3>
                </div>
                <div class="ordertbs-section horiztl-tab">
                  <table id="products-table" style="width: 100%">
                    <thead>
                      <tr>
                        <th>Products </th>
                        <th>Units Sent</th>
                        <th>Units Received</th>
                        <th>Weight for All Units</th>
                        <th>Price per Unit</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for product_list in purchased_item.2 %}
                      <tr>
                        <td> 
                          {% if product_list.0.product.productphoto_set.exists %}
                          {% with photo=product_list.0.product.productphoto_set.first %}
                          <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                            style="height: 64px; width: 64px;">
                          {% endwith %}
                          {% endif %} 
                          {{product_list.0.product.product_title}}
                        </td>
                        <td>
                          <div class="qty-container d-flex align-items-center">
                            <input type="text" value="{{ product_list.1 }}" class="input-qty input-rounded" disabled>
                          </div>
                        </td>
                        <td>
                          <div class="qty-container d-flex align-items-center">
                            <button class="qty-btn-minus btn-primary btn-rounded mr-1" type="button"><i
                              class="bi bi-dash-lg"></i></button>
                            <input type="text" name="sold-item-qty-{{product_list.0.order.orderID}}" value="{{ product_list.1 }}" class="input-qty input-rounded">
                            <button class="qty-btn-plus btn-primary btn-rounded ml-1" type="button"><i
                              class="bi bi-plus-lg"></i></button>
                          </div>
                        </td>
                        <td class="weight-width">
                          <div class="input-group">
                            <input type="number" class="form-control" name="weight-value-{{product_list.0.order.orderID}}" 
                            value="{{ product_list.0.skusold_weight }}" class="input-qty input-rounded" disabled>
                            <select class="selectpicker form-control custom_select" name="weight-unit" style="width: 20px;">
                              {% if product_list.0.product.product_packaging.sku_sold %}
                                {% for choice in unit_choices %}
                                  <option value="{{ choice }}" 
                                  {% if choice == product_list.0.product.product_packaging.sku_sold %} disabled selected 
                                  {% endif %}> {{ choice }}</option>
                                {% endfor %}
                              {% else %}
                                  <option value="notvalid" disabled selected="selected">None</option>
                              {% endif %}
                            </select>
                          </div>
                        </td>
                        <td class="pricing-width">
                          <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" value="{{ product_list.0.total_price}}" class="input-qty input-rounded" disabled>
                          </div>
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer gap-4">
            <button type="button" class="white-btn" data-bs-dismiss="modal"> Cancel</button>
            <button type="button" name="purchased-in-transit-button" class="red-btn" 
            id="purchased-in-transit-{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}" 
            value="{{purchased_item.0.order.orderID}}.{{purchased_item.0.product.supplier.id}}">Mark Delivered</button>
          </div>
        </div>
      </div>
    </div>
<!--  Order in Transit end section pop up -->
  </input>
</form>
{% endfor %}

<!-- Modal pop Delivered Products for purchased -->
{% for purchased_item in purchased_combined %}
<div class="modal fade" id="prchsd-delivered-pop-{{ purchased_item.0.id }}">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content custom-modal-pop">
      <div class="modal-header">
        <h5 class="modal-title">Order Delivered</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="orderproduct-pops">
          <div class="row">
            <div class="col-12 col-md-12 col-lg-6 col-xl-5">
              <div class="ordertbs-section">
                <div class="order-details-form">
                  <div class="order-prod-bx d-flex align-items-center gap-4 mb-5">
                    <div class="orderprod-imgs">
                      {% if purchased_item.0.product.productphoto_set.exists %}
                      {% with photo=purchased_item.0.product.productphoto_set.first %}
                      <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';" style="height: 81px; width: 81px;">
                      {% endwith %}
                      {% endif %}
                    </div>
                    <div class="orderprod-txts">
                      <h3 class="mb-4">Order ID: {{ purchased_item.0.order.orderID }}</h3>
                      <b class="bg-odr">Delivered</b>
                    </div>
                  </div>
                  <div class="rquestsend-row flex-space py-3">
                    <div class="rquest-name gary-txts">
                      <p class="mb-0">Request send</p>
                    </div>
                    <div class="rquest-date black-txts">
                      <p class="mb-0">Jul 24, 2023</p>
                    </div>
                  </div>
                  <div class="rquestsend-row flex-space py-3">
                    <div class="rquest-name gary-txts">
                      <p class="mb-0">Products Delivered</p>
                    </div>
                    <div class="rquest-date black-txts"><b class="bg-odr mb-0">Delivered</b></div>
                  </div>
                  <div class="rquestsend-row flex-space py-3">
                    <div class="rquest-name gary-txts">
                      <p class="mb-0">Purchase date</p>
                    </div>
                    <div class="rquest-date black-txts">
                      <p class="mb-0">{{ purchased_item.0.order.order_date }}</p>
                    </div>
                  </div>
                  <div class="rquestsend-row flex-space py-3">
                    <div class="rquest-name gary-txts">
                      <p class="mb-0">Supplier</p>
                    </div>
                    <div class="rquest-date black-txts">
                      <p class="mb-0">{{purchased_item.0.product.supplier.company.company_name }}</p>
                    </div>
                  </div>
                  <!--
                  <div class="rquestsend-row flex-space py-3">
                    <div class="rquest-name gary-txts">
                      <p class="mb-0">Purchase code</p>
                    </div>
                    <div class="rquest-date black-txts">
                      <p class="mb-0">6373ads-hd73h-8373DS</p>
                    </div>
                  </div>-->
                  <div class="rquestsend-row flex-space py-3">
                    <div class="rquest-name gary-txts">
                      <p class="mb-0">Price <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip"
                          data-bs-placement="top" data-bs-original-title="Lorem ipsum"></i></p>
                    </div>
                    <div class="rquest-date black-txts">
                      <p class="mb-0">${{ purchased_item.0.total_price }}</p>
                    </div>
                  </div>
                </div>
              </div>
              <br>
              <br>
              <button type="button" onclick="window.open('/get-invoice-data/{{ sold_item.0.order.orderID }}/', '_blank')" class="red-btn">Invoice</button>
              <button type="button" onclick="window.open('/get-picklist-data/{{sold_item.0.order.orderID  }}/', '_blank')" class="red-btn">Picking List</button>
            </div>
            <div class="col-12 col-md-12 col-lg-6 col-xl-7">
              <div class="request-change-rgt">
                <div class="tansport-tnfortext mb-5">
                  <h3>Payment</h3>
                </div>
                <div class="expectdel-flexs issueprdt-lists flex-space">
                  <div class="gary-txts">
                    <p class="mb-0">Order Paid
                      {% for data in tooltip_data %}
                      {% if data.tooltip_title|lower == 'item paid' %}
                      <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                        data-bs-original-title="{{ data.tooltip_content}}">
                      </i>
                      {% endif %}
                      {% endfor %}
                    </p>
                  </div>

                  <div class="black-txts d-flex gap-4 align-items-center">
                    <p class="mb-0">No</p>
                    <div class="cust-switch">
                      <label class="switch"><input type="checkbox"><span class="slider round"></span> </label>
                    </div>
                    <p class="mb-0">Yes</p>
                  </div>
                </div>
                
                <div class="expectdel-flexs issueprdt-lists flex-space">
                  <div class="gary-txts">
                    <p class="mb-0">Overall service
                      {% for data in tooltip_data %}
                      {% if data.tooltip_title|lower == 'overall service' %}
                      <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                        data-bs-original-title="{{ data.tooltip_content}}">
                      </i>
                      {% endif %}
                      {% endfor %}
                    </p>
                  </div>
                  <div class="black-txts d-flex gap-4 align-items-center">
                    <p class="mb-0">No</p>
                    <div class="cust-switch">
                      <label class="switch"><input type="checkbox" checked><span class="slider round"></span> </label>
                    </div>
                    <p class="mb-0">Yes</p>
                  </div>
                </div>
                <div class="upload-proof mt-5">
                  <div class="col-12 cus-inputs mb-0">
                    <label class="form-label">Upload image</label>
                  </div>

                  <output id="Filelist"></output>
                  <span class="fileinput-button">
                    <span><i class="bi bi-camera"></i></span>
                    <input type="file" name="files[]" id="files" multiple
                      accept="image/jpeg, image/png, image/gif,"><br />
                  </span>
                </div>
                <div class="col-12 cus-inputs">
                  <label class="form-label">Optional Message
                    <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                      data-bs-original-title="Lorem ipsum"></i>
                  </label>
                  <textarea name="content" class="editor4-{{ purchased_item.0.id }}"></textarea>
                </div>
                <div class="modal-footer gap-4">
                  <a href="{% url 'help' %}" class="white-btn">See an issue?</a>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="hr-line-small my-4 my-sm-5"></div>
            <div class="tab-heading mb-5 mt-3">
              <h3>Products</h3>
            </div>
            <div class="ordertbs-section horiztl-tab">
              <table id="products-table" style="width: 100%">
                <thead>
                  <tr>
                    <th>Products </th>
                    <th>Units Sent
                      <i class="bi bi-exclamation-circle-fill" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-original-title="Request a quantity change while the products have not been picked.">
                      </i>
                    </th>
                    <th>Weight for All Units</th>
                    <th>Price per Unit</th>
                  </tr>
                </thead>
                <tbody>
                  {% for product_list in purchased_item.2 %}
                  <tr>
                    <td> 
                      {% if product_list.0.product.productphoto_set.exists %}
                      {% with photo=product_list.0.product.productphoto_set.first %}
                      <img src="{{ photo.product_photo.url }}" alt="product" onerror="this.onerror=null;this.src='/static/img/Image_not_available.png';"
                        style="height: 64px; width: 64px;">
                      {% endwith %}
                      {% endif %} 
                      {{product_list.0.product.product_title}}
                    </td>
                    <td>
                      <div class="qty-container d-flex align-items-center">
                        <input type="text"
                        value="{{ product_list.1 }}" class="input-qty input-rounded" disabled>
                      </div>
                    </td>
                    <td class="weight-width">
                      <div class="input-group">
                        <input type="number" class="form-control" name="weight-value-{{product_list.0.order.orderID}}" 
                        value="{{ product_list.0.skusold_weight }}" class="input-qty input-rounded" disabled>
                        <select class="selectpicker form-control custom_select" name="weight-unit" style="width: 20px;">
                          {% if product_list.0.product.product_packaging.sku_sold %}
                            {% for choice in unit_choices %}
                              <option value="{{ choice }}" 
                              {% if choice == product_list.0.product.product_packaging.sku_sold %} disabled selected 
                              {% endif %}> {{ choice }}</option>
                            {% endfor %}
                          {% else %}
                              <option value="notvalid" disabled selected="selected">None</option>
                          {% endif %}
                        </select>
                      </div>
                    </td>
                    <td class="pricing-width">
                      <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="number" class="form-control"
                        value="{{ product_list.0.total_price}}" class="input-qty input-rounded" disabled>
                      </div>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer gap-4">
        <button type="button" class="white-btn" data-bs-dismiss="modal"> Cancel</button>
        <button type="button" class="red-btn">Submit</button>
      </div>
    </div>
  </div>
</div>
{% endfor %}


{% block tab %}
{% endblock %}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const orderedSortToggle = document.getElementById('ordered-sort-toggle');
    const inTransitSortToggle = document.getElementById('in-transit-sort-toggle');
    const deliveredSortToggle = document.getElementById('delivered-sort-toggle');
    
    let orderedAsc = true;
    let inTransitAsc = true;
    let deliveredAsc = true;

    // Sorting function
    function sortSection(sectionId, asc) {
      const section = document.getElementById(sectionId);
      const items = Array.from(section.querySelectorAll('.orderid-row'));
      const sortedItems = items.sort((a, b) => {
        const priceA = parseFloat(a.querySelector('.orderid-price p').textContent.replace('$', ''));
        const priceB = parseFloat(b.querySelector('.orderid-price p').textContent.replace('$', ''));
        
        return asc ? priceA - priceB : priceB - priceA;
      });

      sortedItems.forEach(item => section.appendChild(item));  // Reorder items in the section
    }

    // Event Listeners for Sort Toggling
    orderedSortToggle.addEventListener('click', () => {
      orderedAsc = !orderedAsc;
      sortSection('ordered-section', orderedAsc);
    });
    inTransitSortToggle.addEventListener('click', () => {
      inTransitAsc = !inTransitAsc;
      sortSection('in-transit-section', inTransitAsc);
    });
    deliveredSortToggle.addEventListener('click', () => {
      deliveredAsc = !deliveredAsc;
      sortSection('delivered-section', deliveredAsc);
    });
  });
   // Utility function to sort elements
  document.addEventListener('DOMContentLoaded', function () {
    const orderedSortToggle = document.getElementById('sort-ordered');
    const inTransitSortToggle = document.getElementById('sort-in-transit');
    const deliveredSortToggle = document.getElementById('sort-delivered');

    let orderedAsc = true;
    let inTransitAsc = true;
    let deliveredAsc = true;

  function sortSection(sectionSelector, asc) {
    const section = document.querySelector(sectionSelector);
    if (!section) {
      console.error(`Section not found: ${sectionSelector}`);
      return;
    }

    const items = Array.from(section.querySelectorAll('.orderid-row')).filter(item =>
      item.querySelector('.orderid-price p')
    );

    const sortedItems = items.sort((a, b) => {
      const priceA = parseFloat(
        a.querySelector('.orderid-price p')?.textContent.replace('$', '') || 0
      );
      const priceB = parseFloat(
        b.querySelector('.orderid-price p')?.textContent.replace('$', '') || 0
      );

      return asc ? priceA - priceB : priceB - priceA;
    });

    sortedItems.forEach(item => section.appendChild(item));
  }

  orderedSortToggle.addEventListener('click', () => {
    orderedAsc = !orderedAsc;
    sortSection('#purchased-tb .tickets-card:nth-child(1)', orderedAsc);
  });

  inTransitSortToggle.addEventListener('click', () => {
    inTransitAsc = !inTransitAsc;
    sortSection('#purchased-tc', inTransitAsc);
  });

  deliveredSortToggle.addEventListener('click', () => {
    deliveredAsc = !deliveredAsc;
    sortSection('#purchased-td', deliveredAsc);
  });
});
 


document.addEventListener('DOMContentLoaded', (event) => {
  calculateInitialSubtotals();
  document.querySelectorAll('input').forEach(input => {
    input.addEventListener('input', function () {
      const metaValue = this.getAttribute('data-meta');
      calculateSubtotal(metaValue);
    });
  });
});
function calculateInitialSubtotals() {
  const inputs = document.querySelectorAll('input[data-meta]');
  console.log(inputs);
  inputs.forEach(input => {
    const metaValue = input.getAttribute('data-meta');
    calculateSubtotal(metaValue);
  });
}
function calculateSubtotal(metaValue) { 
  // Get the values from the input fields 
  const qty = parseFloat(document.getElementById('sold-item-qty-' + metaValue)?.value) || 0; 
  const weight = parseFloat(document.getElementById('weight-' + metaValue).value) || 0; 
  const unitPrice = parseFloat(document.getElementById('priceSingle-' + metaValue).value) || 0; 
 
  const totalPrice = qty * weight * unitPrice; 
  // Update the subtotal display and hidden field 
  document.getElementById('priceText-' + metaValue).innerHTML = '$' + totalPrice.toFixed(2); 
  document.getElementById('price-' + metaValue).value = totalPrice.toFixed(2);
}
function changeWeight(el) {
    // Get the order ID
    let metaValue = el.getAttribute('data-meta');
    console.log(el.value);
    // Get the values from the input fields
    let qty = parseFloat(document.getElementById('sold-item-qty-' + metaValue).value) || 0; 
    let weight = parseFloat(document.getElementById('weight-' + metaValue).value) || 0;       
    let unitPrice = parseFloat(document.getElementById('priceSingle-' + metaValue).value) || 0;  

    // Calculate the total price
    let totalPrice = qty * weight * unitPrice;

    // Update the subtotal display and hidden field
    document.getElementById('priceText-' + metaValue).innerHTML = '$' + totalPrice.toFixed(2);
    document.getElementById('price-' + metaValue).value = totalPrice.toFixed(2);
}

function changePrice(el) {
    
    let metaValue = el.getAttribute('data-meta');

    // Get the values from the input fields
    let qty = parseFloat(document.getElementById('sold-item-qty-' + metaValue).value) || 0;  // Ensure qty is a valid number
    let weight = parseFloat(document.getElementById('weight-' + metaValue).value) || 0;       // Ensure weight is a valid number
    let unitPrice = parseFloat(el.value) || 0;  

    // Calculate the total price
    let totalPrice = qty * weight * unitPrice;

    // Update the subtotal display and hidden field
    document.getElementById('priceText-' + metaValue).innerHTML = '$' + totalPrice.toFixed(2);
    document.getElementById('price-' + metaValue).value = totalPrice.toFixed(2);
}

//   function roundToDecimalPlaces(num, decimalPlaces) {
//     const factor = Math.pow(10, decimalPlaces); // Calculate 10^decimalPlaces
//     return Math.round(num * factor) / factor;  // Round and then divide
// }
//   function changeWeight(el){
//     // Get the new value of the changed element
//     let metaValue = el.getAttribute('data-meta');
//     let weightUnit = document.getElementById('weightUnit-'+metaValue).value;
//     let unitPrice = document.getElementById('priceSingle-'+metaValue).value;
//     let qty = document.getElementById('sold-item-qty-'+metaValue).value;
//     var totalPrice = 0.00;
//     if(weightUnit == 'Pound' || weightUnit=='Kilo'){
//          totalPrice = el.value * unitPrice;
//     }else{
//        totalPrice = qty * unitPrice;
//     }
//     document.getElementById('priceText-'+metaValue).innerHTML='$'+ totalPrice.toFixed(2);
//     document.getElementById('price-'+metaValue).innerHTML=  totalPrice.toFixed(2);
//   };
//   function changePrice(el){
//     // Get the new value of the changed element
//     let metaValue = el.getAttribute('data-meta');
//     let weightUnit = document.getElementById('weightUnit-'+metaValue).value;
//     let weight = document.getElementById('weight-'+metaValue).value;
//     let qty = document.getElementById('sold-item-qty-'+metaValue).value;
//     var totalPrice = 0.00;
//     if(weightUnit == 'Pound' || weightUnit=='Kilo'){
//          totalPrice = el.value * weight;
//     }else{
//        totalPrice = qty * el.value;
//     }
//     document.getElementById('priceText-'+metaValue).innerHTML='$'+ totalPrice.toFixed(2);
//     document.getElementById('price-'+metaValue).innerHTML=  totalPrice.toFixed(2);
//   };
  function saveTotalPriceToServer(metaValue, totalPrice) {
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;

        fetch('/update-total-price/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrftoken
            },
            body: JSON.stringify({
                orderItemId: metaValue,
                totalPrice: totalPrice
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                console.log('Total price saved successfully');
            } else {
                console.error('Failed to save total price:', data.error);
            }
        })
        .catch(error => console.error('Error:', error));
  }
 
  document.addEventListener('DOMContentLoaded', function () {
    '{% for sold_item in sold_combined %}'
    ClassicEditor
      .create(document.querySelector('.editor12-{{ sold_item.0.id }}'))
      .catch(error => {
        console.error(error);
        alert(error);
      });
    ClassicEditor
      .create(document.querySelector('.editor1-{{ sold_item.0.id }}'))
      .catch(error => {
        console.error(error);
        alert(error);
      });
    ClassicEditor
      .create(document.querySelector('.editor2-{{ sold_item.0.id }}'))
      .catch(error => {
        console.error(error);
        alert(error);
      });
    '{% endfor %}'

    '{% for purchased_item in purchased_combined %}'
    ClassicEditor
      .create(document.querySelector('.editor3-{{ purchased_item.0.id }}'))
      .catch(error => {
        console.error(error);
        alert(error);
      });
    ClassicEditor
      .create(document.querySelector('.editor4-{{ purchased_item.0.id }}'))
      .catch(error => {
        console.error(error);
        alert(error);
      });
    '{% endfor %}' 
  });
</script>

<script>
  $("#rate-delivery").click(function () {
    if ($(this).is(":checked")) {
      $(".hiddenContent").slideDown("fast");
    } else {
      $(".hiddenContent").slideUp("fast");
    }
  });
  $(".damages-click1").click(function () {
    if ($(this).is(":checked")) {
      $(".damages-show1").slideDown("fast");
    } else {
      $(".damages-show1").slideUp("fast");
    }
  });
</script>
<script>
  document.getElementById('damage-other').addEventListener('change', function () {
    var otherOption = document.getElementById('other');
    var selectedOption = this.value;
    otherOption.style.display = (selectedOption === 'other') ? 'block' : 'none';
  });

  document.getElementById('damage-other1').addEventListener('change', function () {
    var otherOption1 = document.getElementById('other1');
    var selectedOption1 = this.value;
    otherOption1.style.display = (selectedOption1 === 'other1') ? 'block' : 'none';
  });
</script>

<script>
  // Get the buttons
  const productsBtn = document.getElementById('sold-btn');
  const requestsBtn = document.getElementById('purchased-btn');

  // Get the rows
  const soldRow = document.getElementById('sold-tb');
  const purchasedRow = document.getElementById('purchased-tb');

  // Function to handle button click
  function handleButtonClick(event) {
    // Reset button styles
    document.querySelectorAll('.nav-link').forEach(btn => {
      btn.style.color = ""; // Reset color
      btn.style.backgroundColor = ""; // Reset background color
    });

    // Set clicked button style
    event.target.style.color = 'var(--c-heading-secondary)';
    event.target.style.backgroundColor = 'var(--c-bg-tab)';

    // Determine which row to show based on the clicked button
    if (event.target === productsBtn) {
      soldRow.classList.add('active');
      purchasedRow.classList.remove('active');
    } else if (event.target === requestsBtn) {
      purchasedRow.classList.add('active');
      soldRow.classList.remove('active');
    }
  }

  // Add event listener to each button
  productsBtn.addEventListener('click', handleButtonClick);
  requestsBtn.addEventListener('click', handleButtonClick);

  // Initially set the first button as active and show the corresponding row
  productsBtn.click();
</script>


<script>
  // form submission for sold ordered modal pop up (editing products)
  document.addEventListener('DOMContentLoaded', (event) => {
  const buttons = document.querySelectorAll('button[name="edit-products-button"]');

  buttons.forEach(button => {
    button.addEventListener('click', function() {
      const itemId = this.value;
      const publishActionInput = document.getElementById(`sold-ordered-publishAction-${itemId}`);
      const form = document.getElementById(`sold-ordered-form-${itemId}`);

      let hiddenField = document.createElement('input');
      hiddenField.setAttribute('type', 'hidden');
      hiddenField.setAttribute('name', 'soldOrderedItemId');
      hiddenField.setAttribute('value', itemId);

      if (publishActionInput && form) {
        publishActionInput.value = 'edit_products';
        form.appendChild(hiddenField);

        form.submit();
      }
    });
  });
});
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function () {
      $('.common-checkbox').change(function () {
          const isChecked = this.checked;
          const productId = $(this).val();
          // Update the corresponding checkbox in the other view
          $(`.common-checkbox[value="${productId}"]`).prop('checked', isChecked);
      });
  });
</script>

<script>
  // form submission for sold ordered modal pop up (transfering to in transit)
  document.addEventListener('DOMContentLoaded', (event) => {
  const buttons = document.querySelectorAll('button[name="sold-ordered-button"]');

  buttons.forEach(button => {
    button.addEventListener('click', function() {
      const itemId = this.value;
      const publishActionInput = document.getElementById(`sold-ordered-publishAction-${itemId}`);
      const form = document.getElementById(`sold-ordered-form-${itemId}`);

      let hiddenField = document.createElement('input');
      hiddenField.setAttribute('type', 'hidden');
      hiddenField.setAttribute('name', 'soldOrderedItemId');
      hiddenField.setAttribute('value', itemId);

      if (publishActionInput && form) {
        publishActionInput.value = 'change_to_in_transit';
        form.appendChild(hiddenField);
        form.submit();
      }
    });
  });
});
</script>



<script>
  // form submission for sold in transit modal pop up (transfering to delivered)
  document.addEventListener('DOMContentLoaded', (event) => {
  const buttons = document.querySelectorAll('button[name="sold-in-transit-button"]');

  buttons.forEach(button => {
    button.addEventListener('click', function() {
      const itemId = this.value;
      const publishActionInput = document.getElementById(`sold-in-transit-publishAction-${itemId}`);
      const form = document.getElementById(`sold-in-transit-form-${itemId}`);

      let hiddenField = document.createElement('input');
      hiddenField.setAttribute('type', 'hidden');
      hiddenField.setAttribute('name', 'soldInTransitItemId');
      hiddenField.setAttribute('value', itemId);

      if (publishActionInput && form) {
        publishActionInput.value = 'change_to_delivered';
        form.appendChild(hiddenField);
        form.submit();
      }
    });
  });
});
</script>

<script>
  // form submission for sold in transit modal pop up payment status update 
  document.addEventListener('DOMContentLoaded', (event) => {
  const buttons = document.querySelectorAll('button[name="sold-in-delivered-button"]');

  buttons.forEach(button => {
    button.addEventListener('click', function() {
      const itemId = this.value;
      const publishActionInput = document.getElementById(`sold-in-delivered-publishAction-${itemId}`);
      const form = document.getElementById(`sold-in-delivered-form-${itemId}`);

      let hiddenField = document.createElement('input');
      hiddenField.setAttribute('type', 'hidden');
      hiddenField.setAttribute('name', 'soldInDeliveredItemId');
      hiddenField.setAttribute('value', itemId);

      if (publishActionInput && form) {
        publishActionInput.value = 'change_to_delivered';
        form.appendChild(hiddenField);
        form.submit();
      }
    });
  });
});
</script>


<script>
  // form submission for purchased ordered (editing products)
  document.addEventListener('DOMContentLoaded', (event) => {
  const buttons = document.querySelectorAll('button[name="purchased-ordered-button"]');

  buttons.forEach(button => {
    button.addEventListener('click', function() {
      const itemId = this.value;
      const publishActionInput = document.getElementById(`purchased-ordered-publishAction-${itemId}`);
      const form = document.getElementById(`purchased-ordered-form-${itemId}`);

      let hiddenField = document.createElement('input');
      hiddenField.setAttribute('type', 'hidden');
      hiddenField.setAttribute('name', 'purchasedOrderedItemId');
      hiddenField.setAttribute('value', itemId);

      if (publishActionInput && form) {
        publishActionInput.value = 'edit_products';
        form.appendChild(hiddenField);
        form.submit();
      }
    });
  });
});
</script>

<script type="text/javascript">
  function printPage(dist) {
    const originalBody = document.body.innerHTML;
    const printableSection = document.getElementById(dist);
    const printContent = printableSection.innerHTML;
    document.body.innerHTML = printContent;
    window.print();  // This triggers the browser's print dialog
    window.location.reload()
  }
  </script>

<script>
  // form submission for purchased in transit (transferring to delivered)
  document.addEventListener('DOMContentLoaded', (event) => {
  const buttons = document.querySelectorAll('button[name="purchased-in-transit-button"]');

  buttons.forEach(button => {
    button.addEventListener('click', function() {
      const itemId = this.value;
      const publishActionInput = document.getElementById(`purchased-in-transit-publishAction-${itemId}`);
      const form = document.getElementById(`purchased-in-transit-form-${itemId}`);

      let hiddenField = document.createElement('input');
      hiddenField.setAttribute('type', 'hidden');
      hiddenField.setAttribute('name', 'purchasedInTransitItemId');
      hiddenField.setAttribute('value', itemId);

      if (publishActionInput && form) {
        publishActionInput.value = 'change_to_delivered';
        form.appendChild(hiddenField);
        form.submit();
      }
    });
  });
});
</script>

<script>
  // Wait for the DOM to be fully loaded
  document.addEventListener('DOMContentLoaded', function() {
      // Attach the click event listener to the button
      document.querySelectorAll('button[name="sold-in-transit-button-in-orderd"]').forEach(function(button) {
          button.addEventListener('click', function() {
              // Get the orderID from the button's value attribute
              var orderID = button.value;

              // Construct the URL for the API
              var url = `/move_to_ordered/?order_id=${orderID}`;

              fetch(url)
                  .then(response => response.json())  // assuming the response is JSON
                  .then(data => {
                      window.location.href = "{% url 'seller_dashboard' %}";
                  })
                  .catch(error => {
                    window.location.href = "{% url 'seller_dashboard' %}";
                      console.error('Error:', error);  // Handle any errors here
                  });
          });
      });
  });
</script>
<script>
  document.querySelectorAll('[data-bs-toggle="modal"]').forEach(button => {
  button.addEventListener('click', event => {
    console.log('Opening modal with ID:', button.getAttribute('data-bs-target'));
  });
});

</script>
{% endblock %}